if [ -z "$TMUX" ]; then
    tmux attach-session -d || tmuxinator start home --suppress-tmux-version-warning && tmux attach-session -d
else
    setopt extendedglob
    autoload -Uz compinit
    for dump in $HOME/.zcompdump(N.mh+24); do
        compinit
        _comp_options+=(globdots)
    done

    {{ template "keybinds.sh" }}
    {{ template "alias.sh" }}

    compinit -C

    DISABLE_AUTO_UPDATE=true
    source $XDG_CONFIG_HOME/zsh/zsh_plugins.sh
    source ~/.tmuxinator/tmuxinator.zsh
    setopt GLOB_DOTS
    setopt PROMPT_SP
    setopt AUTO_PARAM_SLASH
    setopt AUTO_CD
    setopt SHARE_HISTORY
    setopt HIST_IGNORE_DUPS
    setopt HIST_FIND_NO_DUPS
    AGKOZAK_BLANK_LINES=1
    AGKOZAK_CUSTOM_RPROMPT=''
    AGKOZAK_COLORS_PATH=green
    AGKOZAK_CUSTOM_PROMPT='%(?..%B%F{${AGKOZAK_COLORS_EXIT_STATUS}}(%?%)%f%b )%(!.%b%s.%f%b)%B%F{${AGKOZAK_COLORS_PATH}}%2v%f%b%(3V.%F{${AGKOZAK_COLORS_BRANCH_STATUS}}%3v%f.)${AGKOZAK_PROMPT_WHITESPACE}${AGKOZAK_COLORS_PROMPT_CHAR:+%F{${AGKOZAK_COLORS_PROMPT_CHAR}\}}%(4V.${AGKOZAK_PROMPT_CHAR[3]:-:}.%(!.${AGKOZAK_PROMPT_CHAR[2]:-%#}.${AGKOZAK_PROMPT_CHAR[1]:-%#}))${AGKOZAK_COLORS_PROMPT_CHAR:+%f} '

    # Treat these characters as part of a word.
    WORDCHARS='*?_-.[]~&;!#$%^(){}<>'

    export FZF_DEFAULT_COMMAND='fd --type f'
    export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
    export FZF_ALT_C_COMMAND="fd -t d -d 5"
    export ENHANCD_FILTER=fzf

    source /usr/share/fzf/key-bindings.zsh
    source /usr/share/fzf/completion.zsh
    source $XDG_CONFIG_HOME/broot/launcher/bash/br

    source $XDG_CONFIG_HOME/zsh/zsh_overrides.zsh

    zstyle ':completion:*' insert-tab false

fi
